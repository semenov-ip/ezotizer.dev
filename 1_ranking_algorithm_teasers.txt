############################################
Алгоритм ранжирования тизеров
/show/index.php
############################################
После добавления сайта в сеть и его одобрения модератором, сайт начинает откручивать тизеры, находящиеся в сети.
После добавления тизеров им присваивается статус, при котором они моментально начинают откручиваться в сети.

При вызове тизеров, по средствам HTMД-кода, происходит следующее:
1. Проверяется наличие прокси у пользователя. Если есть, обработка прекращается.
2. Проверяется наличие информации о браузере пользователя. Если нет, обработка прекращается.
3. Смотрим с какого сайта идёт запрос блока тизеров. Ищем этот сайт в базе. Если не находим, обработка прекращается.
4. Смотрим передан ли id-блока. Если нет, обработка прекращается.
5. По id-блока выбираем из базы параметры блока. Если блок не найден, обработка прекращается.
6. По id-сайта выбираем из базы параметры сайта.
7. Если у сайта статус "Новый", отправляем его на модерацию (меняем статус на "На модерации").
8. Смотрим, если у сайта статус не "Активный", обработка прекращается.
9. Смотрим, если основной адрес сайта не совпадает с адресом, с которого идет запрос и в алиасах не прописан этот адрес, обработка прекращается.
10. Создаем новую таблицу для логов (logs_2010_10_...), cоответствующую текущей дате, если нужна.
11. Формируем список разрешенных на сайте тематик.
12. Формируем список рекламодателей с положительным балансом.
13. Делаем выборку тизеров из базы с учетом разрещенных тематик, с учетом рекламодателей с положительным балансом,
	с учетом геотаргетинга, временного таргетинга, с учетом забаненых вебмастером к показу тизеров.
14. Полученный список тизеров сортируем по дате последнего показа по возрастанию, этим самым
	мы отбираем тизеры, которые были показаны раньше остальных. Это дает возможность равномерного показа всех тизеров сети.
15. Полученный список тизеров сортируем по цене за клик по уменьшению. Это дает возможность рекламодателям,
	увеличившим цену за клик, получить большее число показов тизеров.
16. Обрабатываем список тизеров. Получаем нужное число тизеров.
17. Формируем HTML для отображения блока с условиями заданными вебмастером.
18. Заносим данные пользователя в таблицу logs_2010_10_...
19. Заносим статистику в таблицы.
20. Формируем css для блока.
21. Возвращаем HTML.

